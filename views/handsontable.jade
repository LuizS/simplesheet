extends layout

block content
  form(method="POST", action="handsontable/saveAll")
    button(type="button",onclick="serializeData()") Save
    input(type="hidden",id="sheetData",value="",name="sheetData")
    div(id="example")
  script.
    console.log("handsontable demo");
    function load(){

    }

    function serializeData()
    {   
        document.getElementById("sheetData").value = JSON.stringify(hot.getData());
        document.forms[0].submit();  
    }

    const data = !{JSON.stringify(Rows)};    
    const hyperformulaInstance = HyperFormula.buildEmpty('internal-use-in-handsontable');
    const container = document.querySelector('#example');

    const hot = new Handsontable(container, {
        data: data,
        rowHeaders: true,
        colHeaders: true,
        height: 'auto',
        licenseKey: 'non-commercial-and-evaluation',
        formulas: {
            engine: HyperFormula,
            }
        });