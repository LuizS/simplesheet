extends layout

block content
  form(method="POST", action="handsontable/saveAll")
    button(type="button",onclick="serializeData()") Save
    input(type="hidden",id="sheetData",value="",name="sheetData")
    div(id="example")
    script(src="javascripts/handsontable.full.min.js")
    script(src="https://cdn.jsdelivr.net/npm/hyperformula/chevrotain@6/lib/chevrotain.min.js")
    script(src="https://cdn.jsdelivr.net/npm/hyperformula/tiny-emitter@2/dist/tinyemitter.min.js")
    script(src="https://cdn.jsdelivr.net/npm/hyperformula/unorm@1/lib/unorm.js")
    script(src="https://cdn.jsdelivr.net/npm/hyperformula/dist/hyperformula.full.min.js")
  script.
    console.log("handsontable demo");
    
    function serializeData()
    {   
        document.getElementById("sheetData").value = JSON.stringify(hot.getData());
        document.forms[0].submit();  
    }
    const data = !{JSON.stringify(Rows)};    

    // create an external HyperFormula instance 
    const hyperformulaInstance = HyperFormula.buildEmpty('internal-use-in-handsontable');

    const container = document.querySelector('#example');
    const hot = new Handsontable(container, {
        data: data,
        rowHeaders: true,
        colHeaders: true,
        height: 'auto',
        licenseKey: 'non-commercial-and-evaluation',
        formulas: {
            engine: HyperFormula,
            }
        });


